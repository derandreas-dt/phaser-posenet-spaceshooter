/*! For license information please see main.f0561be959213b5274b0.bundle.js.LICENSE.txt */
(()=>{var e,t={4215:(e,t,s)=>{"use strict";var i=s(2260);class a extends i.Scene{constructor(){super({key:"BootScene"})}preload(){this.load.json("assets","assets/assets.json")}create(){this.registry.set("options-music",!0),this.registry.set("options-sound",!0),this.registry.set("showVideo",!1),this.registry.set("draw-keypoints",!1),this.registry.set("draw-skeleton",!1),this.scene.start("preload")}}var o=function(e,t,s,i){return new(s||(s=Promise))((function(a,o){function n(e){try{h(i.next(e))}catch(e){o(e)}}function r(e){try{h(i.throw(e))}catch(e){o(e)}}function h(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,r)}h((i=i.apply(e,t||[])).next())}))};var n=s(6452),r=(s(7722),function(e,t,s,i){return new(s||(s=Promise))((function(a,o){function n(e){try{h(i.next(e))}catch(e){o(e)}}function r(e){try{h(i.throw(e))}catch(e){o(e)}}function h(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,r)}h((i=i.apply(e,t||[])).next())}))});const h=["leftWrist","rightWrist"];let c=new Phaser.Geom.Line(1,1,2,2),d=new Phaser.Geom.Circle(1,1,1),l=!1,u=[];const m=(e,t,s,i)=>r(void 0,void 0,void 0,(function*(){s||(s=yield n.zD());const a=f(t).cameras.main.width,o=f(t).cameras.main.height;if(!i){const e=document.querySelector("#output");e.width=a,e.height=o,i=e.getContext("2d")}const r=yield s.estimateSinglePose(e,1,!0,16);i&&t.registry.get("showVideo")&&p(i,e,a,o);const h=r.score,c=r.keypoints;if(h>=.5&&(t.registry.get("draw-keypoints")&&i&&v(c,.5,t),t.registry.get("draw-skeleton")&&w(c,.5,t),Array.isArray(c))){const e=y(c);b(e[0],e[1],t),Math.abs(e[0].position.y-e[1].position.y)<40?g(t,""):e[0].position.y<e[1].position.y?g(t,"right"):e[1].position.y<e[0].position.y&&g(t,"left")}requestAnimationFrame((()=>m(e,t,s,i)))})),p=(e,t,s=640,i=480)=>{e.clearRect(0,0,s,i),e.save(),e.scale(1,1),e.translate(0,0),e.drawImage(t,0,0,s,i),e.restore()},y=e=>{const t=e.filter((e=>h.includes(e.part)));return 2!==t.length?[]:"leftWrist"===t[0].part?[t[0],t[1]]:[t[1],t[0]]},g=(e,t)=>{const s=f(e);s&&("left"===t?s.player.moveLeft():"right"===t?s.player.moveRight():s.player.moveStraight())},f=e=>!!e.scene.isActive(e.scene.current)&&e.scene.getScene(e.scene.current),v=(e,t,s,i=1)=>{for(let a=0,o=e.length;a<o;++a){let o=e[a];if(o.score<t)continue;let{y:n,x:r}=o.position;x(s,n*i,r*i,5,"red")}},w=(e,t,s,i=1)=>{const a=n._X(e,t);u.forEach((e=>e.destroy())),u=[],a.forEach((e=>{S(k(e[0].position),k(e[1].position),s,"green",i)}))},b=(e,t,s,i=1)=>{S(k(e.position),k(t.position),s,"aqua",i)},k=({y:e,x:t})=>[e,t],x=(e,t,s,i,a)=>{e.scene?(l||(l=f(e).add.graphics({fillStyle:{alpha:1,color:11141290}})),d.setTo(s,t,i),l.clear(),l.fillCircleShape(d)):(e.beginPath(),e.arc(s,t,i,0,2*Math.PI),e.fillStyle=a,e.fill())},S=([e,t],[s,i],a,o,n)=>{a.scene?(l||(l=f(a).add.graphics({lineStyle:{width:4,color:11141290}})),c.setTo(t,e,i,s),l.clear(),l.strokeLineShape(c)):(a.beginPath(),a.moveTo(t*n,e*n),a.lineTo(i*n,s*n),a.lineWidth=5,a.strokeStyle=o,a.stroke())};class P extends Phaser.Scene{constructor(){super({key:"preload"})}preload(){this.loadAssets(this.cache.json.get("assets")),this.createProgressbar(this.centerX(),this.centerY()+200)}centerX(){return this.sys.game.config.width/2}centerY(){return this.sys.game.config.height/2}createProgressbar(e,t){let s=e-200,i=t-10,a=new Phaser.Geom.Rectangle(s-2,i-2,404,24);this.add.graphics({lineStyle:{width:5,color:11184810}}).strokeRectShape(a);let h=this.add.graphics(),c=function(e){h.clear(),h.fillStyle(16777215,1),h.fillRect(s,i,400*e,20)};this.load.on("progress",c),this.load.once("complete",(()=>{return e=this,t=void 0,i=function*(){const e=document.querySelector("video");this.game.videoSrc=yield((e,t,s)=>o(void 0,void 0,void 0,(function*(){return yield((e,t,s)=>o(void 0,void 0,void 0,(function*(){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("No Media Devices detected");e.width=t,e.height=s;const i=yield navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:t,height:s}});return e.srcObject=i,new Promise((t=>{e.onloadedmetadata=()=>{t(e)}}))})))(e,t,s)})))(e,this.cameras.main.width,this.cameras.main.height),yield(this.game.videoSrc,r(void 0,void 0,void 0,(function*(){yield n.zD()}))),this.load.off("progress",c),this.scene.start("menu")},new((s=void 0)||(s=Promise))((function(a,o){function n(e){try{h(i.next(e))}catch(e){o(e)}}function r(e){try{h(i.throw(e))}catch(e){o(e)}}function h(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,r)}h((i=i.apply(e,t||[])).next())}));var e,t,s,i}),this)}loadAssets(e){Object.keys(e).forEach((function(t){Object.keys(e[t]).forEach((function(s){let i=e[t][s];"atlas"===t||"unityAtlas"===t||"bitmapFont"===t||"spritesheet"===t||"multiatlas"===t?this.load[t](s,i[0],i[1]):"audio"===t?i.hasOwnProperty("opus")&&this.sys.game.device.audio.opus?this.load[t](s,i.opus):i.hasOwnProperty("webm")&&this.sys.game.device.audio.webm?this.load[t](s,i.webm):i.hasOwnProperty("ogg")&&this.sys.game.device.audio.ogg?this.load[t](s,i.ogg):i.hasOwnProperty("wav")&&this.sys.game.device.audio.wav&&this.load[t](s,i.wav):"html"===t?this.load[t](s,i[0],i[1],i[2]):this.load[t](s,i)}),this)}),this)}}class O extends Phaser.GameObjects.Image{constructor(e,t,s,i,a){a||(a={up:0,down:2,over:1,out:0}),super(i,e,t,s,a.up),this._frames=a,this.setInteractive({useHandCursor:!0}),this.on("pointerup",(()=>{this.setFrame(this._frames.up),this.emit("click",this)}),this),this.on("pointerdown",(()=>{this.setFrame(this._frames.down)}),this),this.on("pointerover",(()=>{this.setFrame(this._frames.over),this.emit("over")}),this),this.on("pointerout",(()=>{this.setFrame(this._frames.out)}),this),i.add.existing(this)}}class _ extends Phaser.GameObjects.Image{constructor(e,t,s,i,a,o){a||(a={on:0,off:1}),super(i,e,t,s,a.on),this.value=void 0!==o&&o,this._frames=a,this.setValueFrame(),this.setInteractive({useHandCursor:!0}),this.on("pointerup",(()=>{this.value=!this.value,this.setValueFrame(),this.emit("changed",this,this.value)}),this),this.on("pointerover",(()=>{this.emit("over"),this.setTint(255)}),this),i.add.existing(this)}setValueFrame(){this.setFrame(this.value?this._frames.on:this._frames.off)}}Phaser.GameObjects.Text;class D extends Phaser.Scene{constructor(){super({key:"menu"})}create(){this.bg=this.add.tileSprite(0,0,this.cameras.main.width,this.cameras.main.height,"background"),this.bg.setOrigin(0,0),this.soundBtnOver=this.sound.add("btnover"),this.soundBtnClick=this.sound.add("btnclick"),this.add.sprite(this.cameras.main.centerX,100,"logo").setOrigin(.5);const e=new O(this.cameras.main.centerX,300,"menu_startgame",this,{up:"menu_startgame_up",down:"menu_startgame_down",over:"menu_startgame_over",out:"menu_startgame_up"});e.on("click",this.onStartGameClick,this),e.on("over",this.onButtonOver,this);const t=new O(this.cameras.main.centerX,400,"menu_options",this,{up:"menu_options_up",down:"menu_options_down",over:"menu_options_over",out:"menu_options_up"});t.on("click",this.onOptionsClick,this),t.on("over",this.onButtonOver,this);const s=new O(this.cameras.main.centerX,500,"menu_howto",this,{up:"menu_howto_up",down:"menu_howto_down",over:"menu_howto_over",out:"menu_howto_up"});s.on("click",this.onHowtoClick,this),s.on("over",this.onButtonOver,this)}onStartGameClick(){this.sfxPlay(this.soundBtnClick),this.scene.start("game")}onOptionsClick(){this.sfxPlay(this.soundBtnClick),this.scene.start("options")}onHowtoClick(){this.sfxPlay(this.soundBtnClick),this.scene.start("howto")}onButtonOver(){this.sfxPlay(this.soundBtnOver)}sfxPlay(e){this.registry.get("options-sound")&&e.play()}update(){this.bg.tilePositionY-=.5}}class B extends Phaser.Scene{constructor(){super({key:"options"})}create(){const e=this.cameras.main.centerX;this.bg=this.add.tileSprite(0,0,this.cameras.main.width,this.cameras.main.height,"background"),this.bg.setOrigin(0,0),this.soundBtnOver=this.sound.add("btnover"),this.soundBtnClick=this.sound.add("btnclick"),this.add.sprite(e,100,"logo").setOrigin(.5);const t=new _(e,300,"menu_music",this,{on:"menu_music_on",off:"menu_music_off"},this.registry.get("options-music"));t.on("changed",this.onMusicChanged,this),t.on("over",this.onButtonOver,this);const s=new _(e,400,"menu_sfx",this,{on:"menu_sfx_on",off:"menu_sfx_off"},this.registry.get("options-sound"));s.on("changed",this.onSoundChanged,this),s.on("over",this.onButtonOver,this);const i=this.add.sprite(e,500,"menu_goback");i.setInteractive(),i.setOrigin(.5),i.on("pointerup",this.onGoBack,this),i.on("pointerover",this.onButtonOver,this),this.add.existing(t),this.add.existing(s)}sfxPlay(e){this.registry.get("options-sound")&&e.play()}onMusicChanged(e,t){this.registry.set("options-music",t),this.sfxPlay(this.soundBtnClick)}onSoundChanged(e,t){this.registry.set("options-sound",t),this.sfxPlay(this.soundBtnClick)}onButtonOver(){this.sfxPlay(this.soundBtnOver)}onGoBack(){this.sfxPlay(this.soundBtnClick),this.scene.start("menu")}update(){this.bg.tilePositionY-=.5}}class C extends Phaser.GameObjects.Text{constructor(e){super(e,10,10,"",{color:"white",fontSize:"28px"}),e.add.existing(this),this.setOrigin(0)}update(){this.setText(`fps: ${Math.floor(this.scene.game.loop.actualFps)}`)}}class T extends Phaser.GameObjects.Text{constructor(e,t){super(e,e.cameras.main.width-100,10,"",{color:"white",fontSize:"28px"}),e.add.existing(this),this.setOrigin(1,0),this.player=t}update(){this.setText(`Health: ${this.player.getData("health")}`)}}class j extends Phaser.GameObjects.Sprite{constructor(e,t,s,i,a){super(e,t,s,i),this.scene.add.existing(this),this.scene.physics.world.enableBody(this,0),this.body.setVelocity(0,0),this.body.setImmovable(!0),this.setData("type",a),this.setData("isDead",!1)}explode(e){this.getData("isDead")||(this.play("explosion"),this.shootTimer&&this.shootTimer.remove(!1),this.on("animationcomplete",(()=>{e?this.destroy():(this.setVisible(!1),this.setActive(!1))})),this.setDead())}setDead(){this.setAngle(0),this.body.setVelocity(0,0),this.setData("isDead",!0)}}class A extends j{constructor(e,t,s,i){super(e,t,s,i||"elaser"),this.body.velocity.y=150}}class F extends j{constructor(e,t,s,i,a){super(e,t,s,i,a||"Enemy"),this.play(i),this.body.velocity.y=Phaser.Math.Between(50,100),this.shootTimer=this.scene.time.addEvent({delay:1500,callback:()=>{const e=new A(this.scene,this.x,this.y);e.setScale(this.scaleX),this.scene.enemyLasers.add(e)},loop:!0})}}class M extends F{constructor(e,t,s){super(e,t,s,"venemy")}}class G extends F{constructor(e,t,s){super(e,t,s,"oenemy")}}class L extends j{constructor(e,t,s,i){super(e,t,s,i||"plaser"),this.body.velocity.y=-500}preUpdate(){(this.y<0||this.y>this.scene.cameras.main.height)&&this.setActive(!1)}}class E extends j{constructor(e,t,s,i){super(e,t,s,i,"Player"),this.setData({speed:200,isShooting:!1,timerShootDelay:10,timerShootTick:9,health:100}),this.animState="fly",this.body.setImmovable(!0)}moveLeft(e){this.body.velocity.x=-this.getData("speed"),e&&(this.animState="fly-left")}moveRight(e){this.body.velocity.x=this.getData("speed"),e&&(this.animState="fly-right")}moveStraight(){this.body.setVelocity(0,0),this.animState="fly"}onDestroy(){this.scene.time.addEvent({delay:1e3,callback:()=>{this.scene.scene.start("gameover")}})}update(){if(this.x=Phaser.Math.Clamp(this.x,0,this.scene.game.config.width),this.y=Phaser.Math.Clamp(this.y,0,this.scene.game.config.height),this.anims.currentAnim&&this.anims.currentAnim.key!==this.animState&&this.play(this.animState),this.getData("isShooting"))if(this.getData("timerShootTick")<this.getData("timerShootDelay"))this.setData("timerShootTick",this.getData("timerShootTick")+1);else{const e=new L(this.scene,this.x,this.y,"plaser");this.scene.playerLasers.add(e),this.scene.sndLaser.play(),this.setData("timerShootTick",0),this.setData("timerShootDelay",Phaser.Math.Between(5,20))}}}class I extends Phaser.Scene{constructor(){super({key:"game"})}preload(){this.game.scene.current="game",this.enemies=this.add.group(),this.enemyLasers=this.add.group(),this.playerLasers=this.add.group(),this.sndLaser=this.sound.add("laser"),this.anims.create({key:"fly",frames:this.anims.generateFrameNumbers("player",{frames:[0,1,2,3]}),frameRate:8,repeat:-1}),this.anims.create({key:"fly-left",frames:this.anims.generateFrameNumbers("player",{frames:[4,5,6,7]}),frameRate:8,repeat:-1}),this.anims.create({key:"fly-right",frames:this.anims.generateFrameNumbers("player",{frames:[8,9,10,11]}),frameRate:8,repeat:-1}),this.anims.create({key:"venemy",frames:this.anims.generateFrameNumbers("venemy",{frames:[0,1,2,3]}),frameRate:8,repeat:-1}),this.anims.create({key:"oenemy",frames:this.anims.generateFrameNumbers("oenemy",{frames:[0,1,2,3]}),frameRate:8,repeat:-1}),this.anims.create({key:"explosion",frames:this.anims.generateFrameNumbers("explosion"),frameRate:8,repeat:0}),this.player=new E(this,this.cameras.main.width/2,this.cameras.main.height-120,"player"),this.player.play("fly"),this.keyA=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),this.keyD=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),this.keySpace=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE),this.fpsText=new C(this),this.healthText=new T(this,this.player),this.time.addEvent({delay:1e3,callback:()=>{let e,t=Phaser.Math.Between(0,10);t>=5?e=new G(this,Phaser.Math.Between(0,this.game.config.width),0):t>=3&&(e=new M(this,Phaser.Math.Between(0,this.game.config.width),0)),e&&this.enemies.add(e)},loop:!0}),this.physics.add.collider(this.playerLasers,this.enemies,((e,t)=>{t&&(t.onDestroy&&t.onDestroy(),t.explode(!0),e.setActive(!1))})),this.physics.add.collider(this.enemyLasers,this.player,((e,t)=>{e.active&&(e.setActive(!1),e.setVisible(!1),t.incData("health",-10))})),this.physics.add.collider(this.enemies,this.player,((e,t)=>{e.getData("isDead")||(e.explode(),e.setData("isDead",!0),t.incData("health",-20))})),m(this.game.videoSrc,this.game)}update(){this.keyA.isDown?this.player.moveLeft(Phaser.Input.Keyboard.JustDown(this.keyA)):this.keyD.isDown&&this.player.moveRight(Phaser.Input.Keyboard.JustDown(this.keyD)),this.keySpace.isDown?this.player.setData("isShooting",!0):(this.player.setData("isShooting",!1),this.player.setData("timerShootTick",this.player.getData("timerShootDelay")-1)),this.player.update(),this.fpsText.update(),this.healthText.update()}}class R extends Phaser.Scene{constructor(){super({key:"howto"})}create(){const e=this.cameras.main.centerX;this.soundBtnOver=this.sound.add("btnover"),this.soundBtnClick=this.sound.add("btnclick"),this.bg=this.add.tileSprite(0,0,this.cameras.main.width,this.cameras.main.height,"background"),this.bg.setOrigin(0,0);const t=this.add.image(e,50,"howto");t.setOrigin(.5,0),t.setScale(1.5,1.5);const s=this.add.sprite(e,700,"menu_goback");s.setInteractive(),s.setOrigin(.5),s.on("pointerup",this.onGoBack,this),s.on("pointerover",this.onButtonOver,this)}sfxPlay(e){this.registry.get("options-sound")&&e.play()}onMusicChanged(e,t){this.registry.set("options-music",t),this.sfxPlay(this.soundBtnClick)}onSoundChanged(e,t){this.registry.set("options-sound",t),this.sfxPlay(this.soundBtnClick)}onButtonOver(){this.sfxPlay(this.soundBtnOver)}onGoBack(){this.sfxPlay(this.soundBtnClick),this.scene.start("menu")}update(){this.bg.tilePositionY-=.5}}window.addEventListener("load",(()=>{var e;const t={title:"T-Figher",type:Phaser.WEBGL,parent:"game",backgroundColor:"#000",scale:{parent:"phaser-game",mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:window.innerWidth,height:window.innerHeight},physics:{default:"arcade",arcade:{debug:!1}},render:{antialiasGL:!1,pixelArt:!0},callbacks:{postBoot:()=>{s()}},canvasStyle:"display: block; width: 100%; height: 100%;",autoFocus:!0,audio:{disableWebAudio:!1},scene:[a,P,D,B,R,I]},s=()=>{i.isBooted&&setTimeout((()=>{i.scale.resize(window.innerWidth,window.innerHeight),i.canvas.setAttribute("style",`display: block; width: ${window.innerWidth}px; height: ${window.innerHeight}px;`)}),100)};window.onresize=()=>s();const i=new Phaser.Game(t);null===(e=document.querySelector("#load"))||void 0===e||e.classList.add("hide")}))},9204:()=>{console.log("%c %c %c %c %c Built using phaser-project-template %c https://github.com/yandeu/phaser-project-template","background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none")},5410:()=>{},8628:()=>{},5042:()=>{}},s={};function i(e){var a=s[e];if(void 0!==a)return a.exports;var o=s[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=t,i.amdD=function(){throw new Error("define cannot be used indirect")},i.amdO={},e=[],i.O=(t,s,a,o)=>{if(!s){var n=1/0;for(c=0;c<e.length;c++){for(var[s,a,o]=e[c],r=!0,h=0;h<s.length;h++)(!1&o||n>=o)&&Object.keys(i.O).every((e=>i.O[e](s[h])))?s.splice(h--,1):(r=!1,o<n&&(n=o));r&&(e.splice(c--,1),t=a())}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,a,o]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={179:0};i.O.j=t=>0===e[t];var t=(t,s)=>{var a,o,[n,r,h]=s,c=0;for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(h)var d=h(i);for(t&&t(s);c<n.length;c++)o=n[c],i.o(e,o)&&e[o]&&e[o][0](),e[n[c]]=0;return i.O(d)},s=self.webpackChunkphaser_project_template=self.webpackChunkphaser_project_template||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),i.O(void 0,[216],(()=>i(4215)));var a=i.O(void 0,[216],(()=>i(9204)));a=i.O(a)})();